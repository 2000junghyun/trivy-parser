{
  "SchemaVersion": 2,
  "CreatedAt": "2025-11-09T16:52:24.095629+09:00",
  "ArtifactName": "terraform-source",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 40,
        "Failures": 0
      }
    },
    {
      "Target": "s3_bad_naming.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 43
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-001",
          "AVDID": "USER-001",
          "Title": "S3 bucket must have a specific name pattern",
          "Description": "Custom check to ensure S3 bucket names follow naming convention\n",
          "Message": "S3 bucket 'test-bucket-67890' does not follow naming convention (must start with 'company-')",
          "Namespace": "user.aws.s3.naming",
          "Query": "data.user.aws.s3.naming.deny",
          "Resolution": "Use proper naming convention for S3 buckets (must start with 'company-')",
          "Severity": "MEDIUM",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 29,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket.another_bad",
                "Filename": "s3_bad_naming.tf",
                "Location": {
                  "StartLine": 28,
                  "EndLine": 34
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-001",
          "AVDID": "USER-001",
          "Title": "S3 bucket must have a specific name pattern",
          "Description": "Custom check to ensure S3 bucket names follow naming convention\n",
          "Message": "S3 bucket 'my-random-bucket-12345' does not follow naming convention (must start with 'company-')",
          "Namespace": "user.aws.s3.naming",
          "Query": "data.user.aws.s3.naming.deny",
          "Resolution": "Use proper naming convention for S3 buckets (must start with 'company-')",
          "Severity": "MEDIUM",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket.bad_naming",
                "Filename": "s3_bad_naming.tf",
                "Location": {
                  "StartLine": 18,
                  "EndLine": 25
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-001",
          "AVDID": "USER-001",
          "Title": "S3 bucket must have a specific name pattern",
          "Description": "Custom check to ensure S3 bucket names follow naming convention\n",
          "Message": "S3 bucket 'unsecured-bucket' does not follow naming convention (must start with 'company-')",
          "Namespace": "user.aws.s3.naming",
          "Query": "data.user.aws.s3.naming.deny",
          "Resolution": "Use proper naming convention for S3 buckets (must start with 'company-')",
          "Severity": "MEDIUM",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 47,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket.no_encryption",
                "Filename": "s3_bad_naming.tf",
                "Location": {
                  "StartLine": 46,
                  "EndLine": 48
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'test-bucket-67890' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.another_bad",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 28,
                  "Content": "resource \"aws_s3_bucket\" \"another_bad\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"another_bad\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  bucket = \"test-bucket-67890\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"test-bucket-67890\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "    Environment = \"staging\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"staging\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'my-random-bucket-12345' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.bad_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"bad_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"bad_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"my-random-bucket-12345\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"my-random-bucket-12345\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"dev\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"dev\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Purpose     = \"testing\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mPurpose\u001b[0m     = \u001b[38;5;37m\"testing\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-data-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.good_naming",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 37,
            "EndLine": 43,
            "Code": {
              "Lines": [
                {
                  "Number": 37,
                  "Content": "resource \"aws_s3_bucket\" \"good_naming\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"good_naming\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  bucket = \"company-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'unsecured-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 46,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 46,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket = \"unsecured-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"unsecured-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "s3_encryption_issues.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 30
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "Public access block does not block public ACLs",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 47,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"insecure_bucket\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  bucket = aws_s3_bucket.insecure_bucket.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.insecure_bucket.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # BAD: Public access is allowed",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  # BAD: Public access is allowed",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  block_public_acls       = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 48,
                  "Content": "  block_public_policy     = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 51
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "Public access block does not block public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 48,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"insecure_bucket\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  bucket = aws_s3_bucket.insecure_bucket.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.insecure_bucket.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # BAD: Public access is allowed",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  # BAD: Public access is allowed",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  block_public_acls       = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  block_public_policy     = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 49,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 51
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"insecure_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-insecure-public-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-insecure-public-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"insecure_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-insecure-public-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-insecure-public-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.kms_encrypted",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 54,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 54,
                  "Content": "resource \"aws_s3_bucket\" \"kms_encrypted\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"kms_encrypted\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  bucket = \"company-secure-kms-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-secure-kms-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"insecure_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-insecure-public-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-insecure-public-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.kms_encrypted",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 54,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 54,
                  "Content": "resource \"aws_s3_bucket\" \"kms_encrypted\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"kms_encrypted\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  bucket = \"company-secure-kms-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-secure-kms-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "Public access block does not ignore public ACLs",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"insecure_bucket\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  bucket = aws_s3_bucket.insecure_bucket.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.insecure_bucket.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # BAD: Public access is allowed",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  # BAD: Public access is allowed",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  block_public_acls       = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  block_public_policy     = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 50,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 51
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "Public access block does not restrict public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 50,
            "EndLine": 50,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket_public_access_block\" \"insecure_bucket\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_public_access_block\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  bucket = aws_s3_bucket.insecure_bucket.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.insecure_bucket.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;239m",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # BAD: Public access is allowed",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  # BAD: Public access is allowed",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  block_public_acls       = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_acls\u001b[0m       = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  block_public_policy     = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mblock_public_policy\u001b[0m     = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  ignore_public_acls      = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mignore_public_acls\u001b[0m      = \u001b[38;5;166mfalse",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  restrict_public_buckets = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  \u001b[38;5;245mrestrict_public_buckets\u001b[0m = \u001b[38;5;166mfalse",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 51
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 19,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"aws_s3_bucket\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  bucket = \"company-aes-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-aes-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"insecure_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-insecure-public-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-insecure-public-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_server_side_encryption_configuration.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 23,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"aes_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_server_side_encryption_configuration\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  bucket = aws_s3_bucket.aes_encryption.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.aes_encryption.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "    apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "      sse_algorithm = \"AES256\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245msse_algorithm\u001b[0m = \u001b[38;5;37m\"AES256\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-insecure-public-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.insecure_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"insecure_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"insecure_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-insecure-public-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-insecure-public-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-unencrypted-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.no_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 34,
            "EndLine": 36,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_s3_bucket\" \"no_encryption\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"no_encryption\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  bucket = \"company-unencrypted-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-unencrypted-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-aes-bucket' must use KMS encryption (currently using AES256)",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_server_side_encryption_configuration.aes_encryption",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 28,
            "EndLine": 28,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"aes_encryption\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_server_side_encryption_configuration\"\u001b[0m \u001b[38;5;37m\"aes_encryption\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  bucket = aws_s3_bucket.aes_encryption.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.aes_encryption.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  rule {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  rule {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "    apply_server_side_encryption_by_default {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    apply_server_side_encryption_by_default {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "      sse_algorithm = \"AES256\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;245msse_algorithm\u001b[0m = \u001b[38;5;37m\"AES256\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "    }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "apply_server_side_encryption_by_default",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 27,
                  "EndLine": 29
                }
              },
              {
                "Resource": "rule",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 26,
                  "EndLine": 30
                }
              },
              {
                "Resource": "aws_s3_bucket_server_side_encryption_configuration.aes_encryption",
                "Filename": "s3_encryption_issues.tf",
                "Location": {
                  "StartLine": 23,
                  "EndLine": 31
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "s3_production_versioning.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 46
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_with_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"aws_s3_bucket\" \"prod_with_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_with_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  bucket = \"company-prod-secure-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-secure-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Backup      = \"enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mBackup\u001b[0m      = \u001b[38;5;37m\"enabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_with_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"aws_s3_bucket\" \"prod_with_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_with_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  bucket = \"company-prod-secure-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-secure-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Backup      = \"enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mBackup\u001b[0m      = \u001b[38;5;37m\"enabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_with_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"aws_s3_bucket\" \"prod_with_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_with_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  bucket = \"company-prod-secure-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-secure-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Backup      = \"enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mBackup\u001b[0m      = \u001b[38;5;37m\"enabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_versioning.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 57,
            "EndLine": 57,
            "Code": {
              "Lines": [
                {
                  "Number": 53,
                  "Content": "resource \"aws_s3_bucket_versioning\" \"prod_versioning_disabled\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_versioning\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  bucket = aws_s3_bucket.prod_versioning_disabled.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.prod_versioning_disabled.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  ",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  versioning_configuration {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  versioning_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "    status = \"Disabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mstatus\u001b[0m = \u001b[38;5;37m\"Disabled\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "versioning_configuration",
                "Filename": "s3_production_versioning.tf",
                "Location": {
                  "StartLine": 56,
                  "EndLine": 58
                }
              },
              {
                "Resource": "aws_s3_bucket_versioning.prod_versioning_disabled",
                "Filename": "s3_production_versioning.tf",
                "Location": {
                  "StartLine": 53,
                  "EndLine": 59
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_with_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"aws_s3_bucket\" \"prod_with_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_with_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  bucket = \"company-prod-secure-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-secure-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Backup      = \"enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mBackup\u001b[0m      = \u001b[38;5;37m\"enabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_with_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"aws_s3_bucket\" \"prod_with_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_with_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  bucket = \"company-prod-secure-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-secure-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Backup      = \"enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mBackup\u001b[0m      = \u001b[38;5;37m\"enabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_with_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"aws_s3_bucket\" \"prod_with_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_with_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  bucket = \"company-prod-secure-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-secure-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Backup      = \"enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mBackup\u001b[0m      = \u001b[38;5;37m\"enabled\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-dev-test-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.dev_bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 97,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"dev_bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"dev_bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  bucket = \"company-dev-test-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-dev-test-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    Environment = \"development\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"development\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-prod-backup-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 49,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_s3_bucket\" \"prod_versioning_disabled\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  bucket = \"company-prod-backup-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-backup-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-003",
          "AVDID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Message": "S3 bucket 'company-production-logs-bucket' has encryption disabled",
          "Namespace": "user.aws.s3.encryption",
          "Query": "data.user.aws.s3.encryption.deny",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-004",
          "AVDID": "USER-004",
          "Title": "Production S3 buckets must have versioning enabled",
          "Description": "S3 buckets with 'prod' in their name must have versioning enabled for data protection\n",
          "Message": "Production bucket 'company-prod-data-bucket' must have versioning enabled",
          "Namespace": "user.aws.s3.advanced",
          "Query": "data.user.aws.s3.advanced.deny",
          "Resolution": "Enable versioning for production S3 buckets",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.prod_no_versioning",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 18,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_s3_bucket\" \"prod_no_versioning\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"prod_no_versioning\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  bucket = \"company-prod-data-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-prod-data-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    Critical    = \"true\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mCritical\u001b[0m    = \u001b[38;5;37m\"true\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-004",
          "AVDID": "USER-004",
          "Title": "Production S3 buckets must have versioning enabled",
          "Description": "S3 buckets with 'prod' in their name must have versioning enabled for data protection\n",
          "Message": "Production bucket 'company-production-logs-bucket' must have versioning enabled",
          "Namespace": "user.aws.s3.advanced",
          "Query": "data.user.aws.s3.advanced.deny",
          "Resolution": "Enable versioning for production S3 buckets",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.production_logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 39,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"aws_s3_bucket\" \"production_logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"production_logs\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  bucket = \"company-production-logs-bucket\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"company-production-logs-bucket\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    Environment = \"production\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mEnvironment\u001b[0m = \u001b[38;5;37m\"production\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type        = \"logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mType\u001b[0m        = \u001b[38;5;37m\"logs\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "USER-004",
          "AVDID": "USER-004",
          "Title": "Production S3 buckets must have versioning enabled",
          "Description": "S3 buckets with 'prod' in their name must have versioning enabled for data protection\n",
          "Message": "Production bucket 'company-prod-backup-bucket' must have versioning enabled",
          "Namespace": "user.aws.s3.advanced",
          "Query": "data.user.aws.s3.advanced.deny",
          "Resolution": "Enable versioning for production S3 buckets",
          "Severity": "HIGH",
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket_versioning.prod_versioning_disabled",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 57,
            "EndLine": 57,
            "Code": {
              "Lines": [
                {
                  "Number": 53,
                  "Content": "resource \"aws_s3_bucket_versioning\" \"prod_versioning_disabled\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket_versioning\"\u001b[0m \u001b[38;5;37m\"prod_versioning_disabled\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "  bucket = aws_s3_bucket.prod_versioning_disabled.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;245mbucket\u001b[0m = aws_s3_bucket.prod_versioning_disabled.id",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "  ",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  ",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "  versioning_configuration {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  versioning_configuration {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "    status = \"Disabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mstatus\u001b[0m = \u001b[38;5;37m\"Disabled\"",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m  }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "versioning_configuration",
                "Filename": "s3_production_versioning.tf",
                "Location": {
                  "StartLine": 56,
                  "EndLine": 58
                }
              },
              {
                "Resource": "aws_s3_bucket_versioning.prod_versioning_disabled",
                "Filename": "s3_production_versioning.tf",
                "Location": {
                  "StartLine": 53,
                  "EndLine": 59
                }
              }
            ]
          }
        }
      ]
    }
  ]
}
