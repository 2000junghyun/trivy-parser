{
  "SchemaVersion": 2,
  "CreatedAt": "2025-11-09T16:52:24.095629+09:00",
  "ArtifactName": "terraform-source",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 40,
        "Failures": 0
      }
    },
    {
      "Target": "s3_bad_naming.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 11
      },
      "Misconfigurations": [
        {
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Namespace": "builtin.aws.s3.aws0093",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "No public access block so not restricting public buckets"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Namespace": "builtin.aws.s3.aws0132",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "Bucket does not encrypt data with a customer managed key."
            }
          ]
        },
        {
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Namespace": "builtin.aws.s3.aws0086",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "No public access block so not blocking public acls"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Namespace": "builtin.aws.s3.aws0087",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "No public access block so not blocking public policies"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Namespace": "builtin.aws.s3.aws0088",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "Bucket does not have encryption enabled"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket does not have encryption enabled"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "Bucket does not have encryption enabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "Bucket does not have encryption enabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Namespace": "builtin.aws.s3.aws0090",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "Bucket does not have versioning enabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Namespace": "builtin.aws.s3.aws0094",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "Bucket does not have a corresponding public access block."
            }
          ]
        },
        {
          "ID": "USER-001",
          "Title": "S3 bucket must have a specific name pattern",
          "Description": "Custom check to ensure S3 bucket names follow naming convention\n",
          "Namespace": "user.aws.s3.naming",
          "Resolution": "Use proper naming convention for S3 buckets (must start with 'company-')",
          "Severity": "MEDIUM",
          "PrimaryURL": "",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 29,
              "EndLine": 29,
              "Message": "S3 bucket 'test-bucket-67890' does not follow naming convention (must start with 'company-')"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 19,
              "Message": "S3 bucket 'my-random-bucket-12345' does not follow naming convention (must start with 'company-')"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 47,
              "EndLine": 47,
              "Message": "S3 bucket 'unsecured-bucket' does not follow naming convention (must start with 'company-')"
            }
          ]
        },
        {
          "ID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Namespace": "user.aws.s3.encryption",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "PrimaryURL": "",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "S3 bucket 'test-bucket-67890' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "S3 bucket 'my-random-bucket-12345' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "S3 bucket 'company-data-bucket' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "S3 bucket 'unsecured-bucket' has encryption disabled"
            }
          ]
        },
        {
          "ID": "s3-bucket-logging",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Namespace": "builtin.aws.s3.aws0089",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "Bucket has logging disabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Namespace": "builtin.aws.s3.aws0091",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.another_bad",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 34,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.bad_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.good_naming",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 37,
              "EndLine": 43,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 46,
              "EndLine": 48,
              "Message": "No public access block so not blocking public acls"
            }
          ]
        }
      ]
    },
    {
      "Target": "s3_encryption_issues.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 10
      },
      "Misconfigurations": [
        {
          "ID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Namespace": "user.aws.s3.encryption",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "PrimaryURL": "",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 41,
              "Message": "S3 bucket 'company-insecure-public-bucket' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "S3 bucket 'company-unencrypted-bucket' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket_server_side_encryption_configuration.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 28,
              "EndLine": 28,
              "Message": "S3 bucket 'company-aes-bucket' must use KMS encryption (currently using AES256)"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Namespace": "builtin.aws.s3.aws0086",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 47,
              "EndLine": 47,
              "Message": "Public access block does not block public ACLs"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Namespace": "builtin.aws.s3.aws0087",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 48,
              "EndLine": 48,
              "Message": "Public access block does not block public policies"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Namespace": "builtin.aws.s3.aws0088",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 41,
              "Message": "Bucket does not have encryption enabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "Bucket does not have encryption enabled"
            }
          ]
        },
        {
          "ID": "s3-bucket-logging",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Namespace": "builtin.aws.s3.aws0089",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 41,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.kms_encrypted",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 54,
              "EndLine": 56,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "Bucket has logging disabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Namespace": "builtin.aws.s3.aws0090",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 41,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.kms_encrypted",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 54,
              "EndLine": 56,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "Bucket does not have versioning enabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Namespace": "builtin.aws.s3.aws0091",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 49,
              "Message": "Public access block does not ignore public ACLs"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Namespace": "builtin.aws.s3.aws0094",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "Bucket does not have a corresponding public access block."
            }
          ]
        },
        {
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Namespace": "builtin.aws.s3.aws0132",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 41,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket_server_side_encryption_configuration.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 23,
              "EndLine": 31,
              "Message": "Bucket does not encrypt data with a customer managed key."
            }
          ]
        },
        {
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Namespace": "builtin.aws.s3.aws0093",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.aes_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 19,
              "EndLine": 21,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.no_encryption",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 34,
              "EndLine": 36,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket_public_access_block.insecure_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 50,
              "EndLine": 50,
              "Message": "Public access block does not restrict public buckets"
            }
          ]
        }
      ]
    },
    {
      "Target": "s3_production_versioning.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 11
      },
      "Misconfigurations": [
        {
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Namespace": "builtin.aws.s3.aws0088",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "Bucket does not have encryption enabled"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "Bucket does not have encryption enabled"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "Bucket does not have encryption enabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Namespace": "builtin.aws.s3.aws0090",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "Bucket does not have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket_versioning.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 57,
              "EndLine": 57,
              "Message": "Bucket does not have versioning enabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Namespace": "builtin.aws.s3.aws0091",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.prod_with_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 62,
              "EndLine": 69,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "No public access block so not blocking public acls"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Namespace": "builtin.aws.s3.aws0093",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.prod_with_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 62,
              "EndLine": 69,
              "Message": "No public access block so not restricting public buckets"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "No public access block so not restricting public buckets"
            }
          ]
        },
        {
          "ID": "USER-003",
          "Title": "S3 bucket must use KMS encryption",
          "Description": "S3 buckets should use AWS KMS for encryption to have better control over encryption keys\n",
          "Namespace": "user.aws.s3.encryption",
          "Resolution": "Enable KMS encryption for S3 bucket",
          "Severity": "HIGH",
          "PrimaryURL": "",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "S3 bucket 'company-dev-test-bucket' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "S3 bucket 'company-prod-backup-bucket' has encryption disabled"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "S3 bucket 'company-production-logs-bucket' has encryption disabled"
            }
          ]
        },
        {
          "ID": "s3-bucket-logging",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Namespace": "builtin.aws.s3.aws0089",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.prod_with_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 62,
              "EndLine": 69,
              "Message": "Bucket has logging disabled"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "Bucket has logging disabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Namespace": "builtin.aws.s3.aws0094",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.prod_with_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 62,
              "EndLine": 69,
              "Message": "Bucket does not have a corresponding public access block."
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "Bucket does not have a corresponding public access block."
            }
          ]
        },
        {
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Namespace": "builtin.aws.s3.aws0132",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "Bucket does not encrypt data with a customer managed key."
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "Bucket does not encrypt data with a customer managed key."
            }
          ]
        },
        {
          "ID": "USER-004",
          "Title": "Production S3 buckets must have versioning enabled",
          "Description": "S3 buckets with 'prod' in their name must have versioning enabled for data protection\n",
          "Namespace": "user.aws.s3.advanced",
          "Resolution": "Enable versioning for production S3 buckets",
          "Severity": "HIGH",
          "PrimaryURL": "",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "Production bucket 'company-prod-data-bucket' must have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "Production bucket 'company-production-logs-bucket' must have versioning enabled"
            },
            {
              "Resource": "aws_s3_bucket_versioning.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 57,
              "EndLine": 57,
              "Message": "Production bucket 'company-prod-backup-bucket' must have versioning enabled"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Namespace": "builtin.aws.s3.aws0086",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.prod_with_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 62,
              "EndLine": 69,
              "Message": "No public access block so not blocking public acls"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "No public access block so not blocking public acls"
            }
          ]
        },
        {
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Namespace": "builtin.aws.s3.aws0087",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "Status": "FAIL",
          "Violations": [
            {
              "Resource": "aws_s3_bucket.dev_bucket",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 91,
              "EndLine": 97,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.prod_no_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 18,
              "EndLine": 25,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.prod_versioning_disabled",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 49,
              "EndLine": 51,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.prod_with_versioning",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 62,
              "EndLine": 69,
              "Message": "No public access block so not blocking public policies"
            },
            {
              "Resource": "aws_s3_bucket.production_logs",
              "Provider": "AWS",
              "Service": "s3",
              "StartLine": 39,
              "EndLine": 46,
              "Message": "No public access block so not blocking public policies"
            }
          ]
        }
      ]
    }
  ]
}